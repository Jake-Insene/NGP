; --------------------------------------------
;              BRANCH CONDITIONAL
; --------------------------------------------
; R10 = Disp
; R11 = Flags

ZERO_FLAG = 1
CARRY_FLAG = 2
NEGATIVE_FLAG = 3
OVERFLOW_FLAG = 4

ZERO_BIT = 1
CARRY_BIT = 2
SIGN_BIT = 4
OVERDLOW_BIT = 8

BEQ_OPC:
	TEST R11, ZERO_BIT
	JZ SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BNE_OPC:
	TEST R11, ZERO_BIT
	JNZ SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BLT_OPC:
	MOV R12, R11
	MOV R13, R11

	SHR R12, NEGATIVE_FLAG-1
	SHR R13, OVERFLOW_FLAG-1
	CMP R12, R13

	JE SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BLE_OPC:
	MOV R12, R11
	MOV R13, R11
	MOV R14, R11

	SHR R12, NEGATIVE_FLAG-1
	SHR R13, OVERFLOW_FLAG-1

	TEST R14, 1
	JNZ BLE_ADDER

	CMP R12, R13
	JE SKIP

BLE_ADDER:
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BGT_OPC:
	MOV R12, R11
	MOV R13, R11
	MOV R14, R11

	SHR R12, NEGATIVE_FLAG-1
	SHR R13, OVERFLOW_FLAG-1

	TEST R14, ZERO_FLAG
	JNZ SKIP

	CMP R12, R13
	JNE SKIP

	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BGE_OPC:
	MOV R12, R11
	MOV R13, R11

	SHR R12, NEGATIVE_FLAG-1
	SHR R13, OVERFLOW_FLAG-1
	CMP R12, R13

	JNE SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BC_OPC:
	TEST R11, CARRY_BIT
	JNZ SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BNC_OPC:
	TEST R11, CARRY_BIT
	JZ SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BN_OPC:
	TEST R11, SIGN_BIT
	JNZ SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BP_OPC:
	TEST R11, SIGN_BIT
	JZ SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BO_OPC:
	TEST R11, OVERDLOW_BIT
	JNZ SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BNO_OPC:
	TEST R11, OVERDLOW_BIT
	JZ SKIP
	
	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BHI_OPC:
	MOV R12, R11
	MOV R13, R11

	SHR R12, CARRY_FLAG

	TEST R12, 1
	JNZ SKIP

	TEST R13, 1
	JZ SKIP

	ADD_REGISTER R10D, PC_INDEX

	JMP CONTINUE_ADDRESS
BLS_OPC:
	MOV R12, R11
	MOV R13, R11

	SHR R12, CARRY_FLAG

	TEST R12, 1
	JZ BLS_ADDER

	TEST R13, 1
	JNZ SKIP

BLS_ADDER:
	ADD_REGISTER R10D, PC_INDEX

	JMP SKIP

SKIP:
	JMP CONTINUE_ADDRESS
BAL_OPC:
	ADD_REGISTER R10D, PC_INDEX
	JMP CONTINUE_ADDRESS
BNV_OPC:
	; Do nothing
	JMP CONTINUE_ADDRESS
	
